<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apex Match Logger</title>
<style>
  body { font-family: Arial, sans-serif; background: #121212; color: #fff; padding: 20px; }
  h1 { text-align: center; }
  label { display: block; margin-top: 10px; }
  input { width: 100%; padding: 8px; margin-top: 5px; border: none; border-radius: 5px; }
  button { margin-top: 15px; padding: 10px; border: none; background: #e53935; color: white; cursor: pointer; border-radius: 5px; width: 100%; }
  button:hover { background: #d32f2f; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #444; padding: 8px; text-align: center; }
  th { background: #222; }
  .stats { margin-top: 20px; background: #1e1e1e; padding: 15px; border-radius: 8px; }
  canvas { background: #1e1e1e; border-radius: 8px; padding: 10px; }
</style>

<script>
// Admin-Passwortschutz fÃ¼r direkten Aufruf des Match Loggers
document.addEventListener("DOMContentLoaded", function () {
    var adminPass = prompt("ðŸ”’ Admin-Passwort fÃ¼r Match Logger:");
    if (adminPass !== "Admin8112") { // Muss gleich wie in index.html sein
        alert("Kein Zugriff auf Match Logger!");
        window.location.href = "index.html";
    }
});
</script>
</head>
<body>

<h1>ðŸ”« Apex Match Logger</h1>

<!-- Neues Datumseingabefeld -->
<label>Datum:</label>
<input type="date" id="date">

<label>Placement:</label>
<input type="number" id="placement" min="1" max="20">

<label>Kills:</label>
<input type="number" id="kills" min="0">

<label>Tode:</label>
<input type="number" id="deaths" min="0">

<label>Damage:</label>
<input type="number" id="damage" min="0">

<label>RP Gewinn/Verlust:</label>
<input type="number" id="rp" min="-500">

<button onclick="addMatch()">Match speichern</button>

<div class="stats">
  <p><strong>Durchschnitt Kills:</strong> <span id="avgKills">0</span></p>
  <p><strong>Durchschnitt Damage:</strong> <span id="avgDamage">0</span></p>
  <p><strong>Gesamt RP:</strong> <span id="totalRP">0</span></p>
  <p><strong>K/Dâ€‘Quote:</strong> <span id="kdRatio">0</span></p>
</div>

<canvas id="rpChart" height="100"></canvas>

<table id="matchTable">
  <thead>
    <tr>
      <th>#</th>
      <th>Datum</th>
      <th>Placement</th>
      <th>Kills</th>
      <th>Tode</th>
      <th>Damage</th>
      <th>RP</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let matches = JSON.parse(localStorage.getItem('apexMatches')) || [];

function updateStats() {
  if (matches.length === 0) return;

  let totalKills = matches.reduce((sum, m) => sum + m.kills, 0);
  let totalDamage = matches.reduce((sum, m) => sum + m.damage, 0);
  let totalRP = matches.reduce((sum, m) => sum + m.rp, 0);
  let totalDeaths = matches.reduce((sum, m) => sum + m.deaths, 0);

  let avgKills = totalKills / matches.length;
  let avgDamage = totalDamage / matches.length;
  let kdRatio = totalDeaths > 0 ? (totalKills / totalDeaths).toFixed(2) : totalKills.toFixed(2);

  document.getElementById('avgKills').textContent = avgKills.toFixed(1);
  document.getElementById('avgDamage').textContent = avgDamage.toFixed(0);
  document.getElementById('totalRP').textContent = totalRP;
  document.getElementById('kdRatio').textContent = kdRatio;
}

function renderTable() {
  let tbody = document.querySelector("#matchTable tbody");
  tbody.innerHTML = "";
  matches.forEach((m, i) => {
    let row = `<tr>
      <td>${i + 1}</td>
      <td>${m.date || "-"}</td>
      <td>${m.placement}</td>
      <td>${m.kills}</td>
      <td>${m.deaths}</td>
      <td>${m.damage}</td>
      <td>${m.rp}</td>
    </tr>`;
    tbody.innerHTML += row;
  });
}

function renderChart() {
  let ctx = document.getElementById('rpChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: matches.map((m, i) => m.date ? `${m.date}` : `Match ${i+1}`),
      datasets: [{
        label: 'RP-Verlauf',
        data: matches.map(m => m.rp),
        borderColor: '#e53935',
        fill: false
      }]
    }
  });
}

function addMatch() {
  let date = document.getElementById('date').value;
  let placement = parseInt(document.getElementById('placement').value) || 0;
  let kills = parseInt(document.getElementById('kills').value) || 0;
  let deaths = parseInt(document.getElementById('deaths').value) || 0;
  let damage = parseInt(document.getElementById('damage').value) || 0;
  let rp = parseInt(document.getElementById('rp').value) || 0;

  matches.push({ date, placement, kills, deaths, damage, rp });
  localStorage.setItem('apexMatches', JSON.stringify(matches));

  updateStats();
  renderTable();
  renderChart();
}

updateStats();
renderTable();
renderChart();
</script>

</body>
</html>
